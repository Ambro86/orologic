def CalculateBestLine(board):
	global ENGINE, analysis_time, multipv
	try:
		analysis = ENGINE.analyse(board, chess.engine.Limit(time=analysis_time), multipv=multipv)
		best_line = analysis[0].get("pv", [])
		score = analysis[0].get("score")
		temp_board = board.copy()
		moves_san = []
		for move in best_line:
			moves_san.append(temp_board.san(move))
			temp_board.push(move)
		moves_str = " ".join(moves_san)
		if score is not None and score.is_mate():
			mate_moves = abs(score.mate())
			return f"Matto in {mate_moves}, {moves_str}"
		else:
			return moves_str
	except Exception as e:
		print("Errore in CalculateBestLine:", e)
		return None
